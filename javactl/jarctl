#!/bin/bash
#
# Controls to build and manipulate jar archives
#
# jar options
#
# c - create new jar
# u - update jar
# x - extract jar
#
# v - verbose
# f - create file
# m - specify Manifest.txt
# e - specify program entry point
#

COMPILED='*.jar'
MANIFEST="Manifest.txt"
JAR_CREATE="jar cvf"
JAR_UPDATE="jar uvf"
USE_MANIFEST="m"
USE_ENTRY_POINT="e"

program=$(basename "$0")
action="$1"


clean() {
        for file in $COMPILED
        do
                rm -f "$file"
        done
}


build_jar() {

        if [[ "$1" = "create" ]]; then
                jar_command="$JAR_CREATE"
        else
                jar_command="$JAR_UPDATE"
        fi

        shift

        if [[ "$1" = "$MANIFEST" ]]; then
                shift
                jar_name="${1%.*}.jar"
                jar_command="$jar_command$USE_MANIFEST $jar_name $MANIFEST $@"
        else
                jar_name="${1%.*}.jar"
                entry_point="${1%.*}"
                jar_command="$jar_command$USE_ENTRY_POINT $jar_name $entry_point $@"
        fi


        $jar_command
}


case "$action" in
        create | update)
                build_jar "$@"
                ;;
        clean)
                clean
                ;;
        *)
                echo "Error!"
                exit 1
                ;;
esac

