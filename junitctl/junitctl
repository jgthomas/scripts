#!/bin/bash
#
# Script assumes the classes to be tested and the junit tests
# are all in the same directory
#

program=$(basename "$0")
action="$1"
testclass="$2"

junit="/usr/share/java/junit-4.12.jar"
hamcrest="/usr/share/java/hamcrest/core-1.3.jar"
runclass="org.junit.runner.JUnitCore"


usage() {
        printf "\nUsage: $program command [target]\n\n"
        printf '%-10s%-25s%-25s \n' "help" "" "display this message"
        printf '%-10s%-25s%-25s \n' "clean" "" "delete all compiled files"
        printf '%-10s%-25s%-25s \n' "compile" "TestClassName.java" "compile the tests"
        printf '%-10s%-25s%-25s \n' "run" "TestClassName" "run the tests"
}


case "$action" in
        compile)
                javac -classpath "$(pwd)":"$junit" "$testclass"
                ;;
        run)
                java -classpath "$(pwd)":"$junit":"$hamcrest" "$runclass" "${testclass%.*}"
                ;;
        clean)
                rm -f *.class
                ;;
        help)
                usage
                ;;
        *)
                echo "Unrecognised action: $1"
                usage
                exit 1
                ;;
esac
